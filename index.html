<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Integrated Sport Performance Assessment</title>
    <style>

      :root {
        --bg: #0a0b0c;
        --bg-accent: #101214;
        --ink: #f7f7f2;
        --muted: #9ea4a8;
        --accent: #d1b15a;
        --accent-strong: #f1d07a;
        --neon: #86c7cf;
        --graff: #d86b78;
        --card: rgba(16, 18, 20, 0.9);
        --line: rgba(255, 255, 255, 0.08);
        --shadow: 0 24px 60px rgba(0, 0, 0, 0.5);
        --glass: rgba(255, 255, 255, 0.06);
        --focus: rgba(241, 208, 122, 0.6);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Space Grotesk", "Helvetica Neue", sans-serif;
        background: radial-gradient(circle at top left, #171a1e 0%, var(--bg) 45%, #050505 100%);
        color: var(--ink);
        min-height: 100vh;
      }

      h1 {
        font-family: "Cormorant Garamond", serif;
        font-size: clamp(2.2rem, 3.5vw, 3.6rem);
        letter-spacing: 0.02em;
      }

      h2, h3, h4 {
        margin: 0 0 12px;
        font-weight: 600;
      }

      p {
        margin: 0 0 12px;
        color: var(--muted);
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .hero {
        padding: 64px 8vw 32px;
      }

      .hero--landing {
        position: relative;
        border-bottom: 1px solid var(--line);
      }

      .hero--landing::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(120deg, rgba(255, 255, 255, 0.02), transparent 50%);
        pointer-events: none;
      }

      .section {
        padding: 32px 8vw;
      }

      .card {
        background: var(--card);
        border-radius: 20px;
        padding: 24px;
        border: 1px solid var(--line);
        box-shadow: var(--shadow);
      }

      .card.luxe {
        border: 1px solid rgba(212, 175, 55, 0.4);
        background: linear-gradient(140deg, rgba(17, 20, 23, 0.98), rgba(8, 9, 10, 0.92));
      }

      .badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.06);
        border-radius: 999px;
        font-size: 0.85rem;
        color: var(--accent-strong);
        border: 1px solid rgba(255, 255, 255, 0.12);
        text-transform: uppercase;
        letter-spacing: 0.12em;
      }

      .grid {
        display: grid;
        gap: 20px;
      }

      .grid.two {
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      }

      .grid.three {
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
      }

      label {
        display: block;
        font-size: 0.85rem;
        margin-bottom: 6px;
        color: var(--muted);
      }

      select,
      input,
      textarea {
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid var(--line);
        min-width: 220px;
        font-size: 1rem;
        background: #0d0f12;
        color: var(--ink);
      }

      button {
        background: var(--ink);
        color: #0b0c0d;
        border: none;
        padding: 12px 20px;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 600;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
      }

      button:focus-visible,
      .vial:focus-visible,
      select:focus-visible,
      input:focus-visible {
        outline: 2px solid var(--focus);
        outline-offset: 3px;
      }

      button.secondary {
        background: transparent;
        color: var(--ink);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      button.ghost {
        background: transparent;
        color: var(--accent-strong);
        border: 1px solid rgba(212, 175, 55, 0.35);
      }

      .pillar-card {
        border: 1px solid var(--line);
        border-radius: 18px;
        padding: 16px;
        background: rgba(9, 10, 12, 0.9);
      }

      .likert {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      .likert label {
        border: 1px solid var(--line);
        border-radius: 12px;
        padding: 8px 10px;
        cursor: pointer;
        min-width: 36px;
        text-align: center;
        background: #0d0f12;
        margin: 0;
      }

      .likert input {
        display: none;
      }

      .likert input:checked + span {
        background: var(--accent);
        color: #0b0c0d;
        border-radius: 10px;
        padding: 4px 8px;
      }

      .scale {
        display: grid;
        gap: 12px;
      }

      .movement-grid {
        display: grid;
        gap: 16px;
      }

      .movement-card {
        border: 1px dashed var(--line);
        border-radius: 16px;
        padding: 16px;
        background: rgba(12, 14, 17, 0.9);
      }

      .movement-placeholder {
        height: 140px;
        border-radius: 12px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04), rgba(212, 175, 55, 0.08));
        display: grid;
        place-items: center;
        color: var(--muted);
        font-size: 0.9rem;
      }

      .flag {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        border-radius: 999px;
        font-size: 0.85rem;
      }

      .flag.low {
        background: rgba(255, 77, 109, 0.2);
        color: var(--graff);
      }

      .flag.avg {
        background: rgba(212, 175, 55, 0.2);
        color: var(--accent-strong);
      }

      .flag.high {
        background: rgba(141, 243, 255, 0.2);
        color: var(--neon);
      }

      .radar-wrap {
        width: 100%;
        min-height: 320px;
      }

      .hidden {
        display: none;
      }

      ul {
        padding-left: 20px;
        margin: 8px 0;
        color: var(--muted);
      }

      .cockpit-grid {
        display: grid;
        gap: 20px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }

      .widget {
        background: linear-gradient(160deg, rgba(15, 18, 22, 0.98), rgba(6, 7, 9, 0.96));
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 20px;
        padding: 20px;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
      }

      .widget::after {
        content: "";
        position: absolute;
        inset: 1px;
        border-radius: 18px;
        border: 1px solid rgba(212, 175, 55, 0.08);
        pointer-events: none;
      }

      .hero-widget {
        grid-column: span 2;
      }

      .chip {
        display: inline-flex;
        align-items: center;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.06);
        text-transform: uppercase;
        letter-spacing: 0.12em;
        font-size: 0.7rem;
        color: var(--accent-strong);
      }

      .big-number {
        font-size: 3rem;
        font-weight: 700;
        margin-top: 12px;
      }

      .big-label {
        font-size: 1.4rem;
        font-weight: 600;
        margin: 12px 0;
      }

      .dial-grid {
        display: grid;
        gap: 16px;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }

      .dial {
        --value: 0;
        width: 120px;
        height: 120px;
        margin: 16px auto 10px;
        border-radius: 50%;
        background: conic-gradient(var(--accent) calc(var(--value) * 1%), rgba(255, 255, 255, 0.08) 0);
        position: relative;
        display: grid;
        place-items: center;
        text-align: center;
      }

      .dial::after {
        content: "";
        position: absolute;
        width: 88px;
        height: 88px;
        border-radius: 50%;
        background: #0b0c0d;
        border: 1px solid rgba(255, 255, 255, 0.06);
      }

      .dial span {
        position: relative;
        font-size: 1.4rem;
        font-weight: 700;
        z-index: 1;
      }

      .dial em {
        position: relative;
        z-index: 1;
        font-style: normal;
        font-size: 0.75rem;
        color: var(--muted);
        letter-spacing: 0.08em;
      }

      .pill {
        display: inline-flex;
        justify-content: center;
        padding: 4px 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.05);
        font-size: 0.75rem;
        color: var(--muted);
      }

      .infographic {
        display: grid;
        gap: 12px;
      }

      .stats-strip {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        border-top: 1px solid var(--line);
        border-bottom: 1px solid var(--line);
        padding: 24px 0;
        margin-top: 24px;
      }

      .stat {
        display: grid;
        gap: 6px;
      }

      .stat strong {
        font-size: 1.6rem;
      }

      .intro-block {
        max-width: 640px;
        display: grid;
        gap: 12px;
      }

      .vial-section {
        display: grid;
        gap: 24px;
      }

      .vial-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 22px;
      }

      .vial {
        background: transparent;
        border: none;
        padding: 0;
        display: grid;
        gap: 10px;
        text-align: center;
        color: inherit;
        cursor: pointer;
      }

      .vial-glass {
        position: relative;
        width: 100%;
        height: 220px;
        border-radius: 999px;
        border: 1px solid var(--line);
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.02));
        overflow: hidden;
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
      }

      .vial-cap {
        position: absolute;
        top: -12px;
        left: 50%;
        transform: translateX(-50%);
        width: 60%;
        height: 20px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.12);
      }

      .vial-fill {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: var(--fill, 35%);
        background: linear-gradient(180deg, rgba(209, 177, 90, 0.8), rgba(134, 199, 207, 0.4));
        transition: height 0.6s ease;
        filter: blur(0.2px);
      }

      .vial.is-active .vial-fill,
      .vial:focus-visible .vial-fill {
        height: 70%;
      }

      .vial-glass::after {
        content: "";
        position: absolute;
        inset: 8px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.06);
        pointer-events: none;
      }

      .vial-label {
        font-size: 0.85rem;
        color: var(--muted);
        letter-spacing: 0.04em;
      }

      .tooltip {
        position: absolute;
        bottom: -40px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(11, 12, 13, 0.9);
        color: var(--ink);
        border: 1px solid var(--line);
        padding: 8px 12px;
        border-radius: 12px;
        font-size: 0.75rem;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease, transform 0.2s ease;
      }

      .vial.is-active .tooltip,
      .vial:focus-visible .tooltip {
        opacity: 1;
        transform: translate(-50%, -6px);
      }

      .vial.is-active .vial-glass {
        box-shadow: 0 0 16px rgba(241, 208, 122, 0.25);
        transform: scale(1.01);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .wheel-section {
        display: grid;
        gap: 24px;
      }

      .wheel-wrap {
        position: relative;
        display: grid;
        place-items: center;
        min-height: 380px;
      }

      .wheel {
        width: 320px;
        height: 320px;
        border-radius: 50%;
        background: conic-gradient(
          from 90deg,
          rgba(209, 177, 90, 0.9),
          rgba(241, 208, 122, 0.8),
          rgba(212, 156, 90, 0.75),
          rgba(171, 125, 84, 0.8),
          rgba(209, 177, 90, 0.9)
        );
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.6);
        position: relative;
      }

      .wheel::after {
        content: "";
        position: absolute;
        inset: 18px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(10, 11, 12, 0.85);
      }

      .wheel-center {
        position: absolute;
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: rgba(8, 9, 10, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.1);
        display: grid;
        place-items: center;
        text-align: center;
        font-size: 0.75rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        color: var(--accent-strong);
        z-index: 2;
      }

      .wheel-node {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%)
          rotate(var(--angle))
          translate(180px)
          rotate(calc(var(--angle) * -1));
        background: rgba(13, 15, 18, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.12);
        color: var(--ink);
        border-radius: 999px;
        padding: 6px 12px;
        font-size: 0.7rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        z-index: 3;
      }

      .wheel-node:hover,
      .wheel-node:focus-visible {
        box-shadow: 0 0 16px rgba(241, 208, 122, 0.35);
        transform: translate(-50%, -50%)
          rotate(var(--angle))
          translate(180px)
          rotate(calc(var(--angle) * -1))
          scale(1.03);
      }

      .wheel-node .tooltip {
        position: absolute;
        bottom: -44px;
        left: 50%;
        transform: translateX(-50%);
      }

      .wheel-node:hover .tooltip,
      .wheel-node:focus-visible .tooltip {
        opacity: 1;
        transform: translate(-50%, -6px);
      }

      .modal {
        position: fixed;
        inset: 0;
        background: rgba(5, 6, 7, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        z-index: 10;
      }

      .modal.is-open {
        opacity: 1;
        pointer-events: auto;
      }

      .modal-card {
        width: min(480px, 92vw);
        background: rgba(14, 16, 18, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        padding: 24px;
        box-shadow: var(--shadow);
        display: grid;
        gap: 12px;
      }

      .modal-card h3 {
        margin: 0;
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: 8px;
      }

      .reveal {
        opacity: 0;
        transform: translateY(12px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }

      .reveal.is-visible {
        opacity: 1;
        transform: translateY(0);
      }

      .bar-row {
        display: grid;
        grid-template-columns: 160px 1fr 40px;
        gap: 12px;
        align-items: center;
        font-size: 0.9rem;
      }

      .bar {
        height: 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        overflow: hidden;
      }

      .bar-fill {
        height: 100%;
        border-radius: inherit;
        background: linear-gradient(90deg, var(--accent), var(--neon));
      }

      .bar-row.psychological .bar-fill {
        background: linear-gradient(90deg, #8df3ff, #3ed6ff);
      }

      .bar-row.physical .bar-fill {
        background: linear-gradient(90deg, #d4af37, #f5d76e);
      }

      .bar-row.technical .bar-fill {
        background: linear-gradient(90deg, #ff4d6d, #ff8fab);
      }

      .bar-row.tactical .bar-fill {
        background: linear-gradient(90deg, #7f7bff, #b9a7ff);
      }

      .bar-row.nutrition .bar-fill {
        background: linear-gradient(90deg, #45f3b4, #8dffdc);
      }

      .bar-row.health .bar-fill {
        background: linear-gradient(90deg, #ffb86b, #ffe0a6);
      }

      .bar-row.environment .bar-fill {
        background: linear-gradient(90deg, #6be1ff, #b8f1ff);
      }

      .lollipop {
        margin-top: 16px;
        display: grid;
        gap: 12px;
      }

      .lollipop-track {
        position: relative;
        height: 10px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
      }

      .lollipop-center {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 2px;
        height: 26px;
        background: rgba(212, 175, 55, 0.8);
      }

      .lollipop-dot {
        position: absolute;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 18px;
        height: 18px;
        border-radius: 50%;
        border: 2px solid rgba(255, 255, 255, 0.4);
        background: rgba(212, 175, 55, 0.7);
        box-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
      }

      .lollipop-dot.low {
        background: rgba(255, 77, 109, 0.8);
        box-shadow: 0 0 10px rgba(255, 77, 109, 0.6);
      }

      .lollipop-dot.high {
        background: rgba(141, 243, 255, 0.8);
        box-shadow: 0 0 10px rgba(141, 243, 255, 0.6);
      }

      .lollipop-labels {
        display: flex;
        justify-content: space-between;
        font-size: 0.75rem;
        color: var(--muted);
      }

      footer {
        padding: 24px 8vw 48px;
        color: var(--muted);
        font-size: 0.9rem;
      }

      @media (max-width: 720px) {
        .hero {
          padding: 48px 6vw 24px;
        }

        .section {
          padding: 24px 6vw;
        }

        select,
        input,
        textarea {
          min-width: 180px;
          width: 100%;
        }

        .hero-widget {
          grid-column: span 1;
        }

        .bar-row {
          grid-template-columns: 1fr;
        }

        .wheel {
          width: 260px;
          height: 260px;
        }

        .wheel-node {
          transform: translate(-50%, -50%)
            rotate(var(--angle))
            translate(150px)
            rotate(calc(var(--angle) * -1));
        }

        .wheel-node:hover,
        .wheel-node:focus-visible {
          transform: translate(-50%, -50%)
            rotate(var(--angle))
            translate(150px)
            rotate(calc(var(--angle) * -1))
            scale(1.03);
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          transition: none !important;
          animation: none !important;
          scroll-behavior: auto !important;
        }
      }
    </style>
  </head>
  <body>
    <div id="app"></div>

    <script>
      const sports = [
        {
          name: "Athletics (Track & Field)",
          slug: "athletics",
          season: "summer",
          category: "mixed",
          environment: "outdoor track and field venues",
          loadTypes: ["speed", "power", "endurance", "impact"],
          competition: "seasonal meets with peak championships",
          keyDemands: ["maximal speed", "technical execution", "repeatability"],
          signatureSkills: ["sprint mechanics", "event pacing", "technical consistency"],
          riskProfile: "hamstring, tendon, and impact-related overuse",
          equipment: "minimal equipment, event-specific implements",
        },
        {
          name: "Swimming",
          slug: "swimming",
          season: "summer",
          category: "endurance",
          environment: "pool-based aquatic environment",
          loadTypes: ["endurance", "power", "shoulder load"],
          competition: "heat-based meets with precise race tapering",
          keyDemands: ["aerobic capacity", "stroke efficiency", "race pacing"],
          signatureSkills: ["turn execution", "start reaction", "stroke rate control"],
          riskProfile: "shoulder overuse and fatigue management",
          equipment: "pool, racing suit, starting blocks",
        },
        {
          name: "Marathon Swimming",
          slug: "marathon-swimming",
          season: "summer",
          category: "endurance",
          environment: "open water courses",
          loadTypes: ["endurance", "temperature stress", "navigation"],
          competition: "long-distance races with single peak events",
          keyDemands: ["aerobic efficiency", "drafting awareness", "fueling timing"],
          signatureSkills: ["open water sighting", "stroke economy", "pack navigation"],
          riskProfile: "hypothermia, shoulder load, and fatigue risk",
          equipment: "open water suit, cap, goggles",
        },
        {
          name: "Artistic Swimming",
          slug: "artistic-swimming",
          season: "summer",
          category: "skill",
          environment: "pool-based aquatic environment",
          loadTypes: ["breath control", "isometric strength", "skill"],
          competition: "routine-based scoring with seasonal peaks",
          keyDemands: ["synchronization", "core control", "artistry"],
          signatureSkills: ["underwater movement", "routine timing", "expressive control"],
          riskProfile: "lumbar and shoulder load, apnea stress",
          equipment: "pool, choreography audio",
        },
        {
          name: "Diving",
          slug: "diving",
          season: "summer",
          category: "skill",
          environment: "platform and springboard facilities",
          loadTypes: ["impact", "precision", "rotation"],
          competition: "multi-round judged events",
          keyDemands: ["spatial awareness", "entry control", "explosive takeoff"],
          signatureSkills: ["rotation timing", "aerial control", "clean entry"],
          riskProfile: "shoulder, spine, and impact load",
          equipment: "springboard or platform",
        },
        {
          name: "Water Polo",
          slug: "water-polo",
          season: "summer",
          category: "collision",
          environment: "deep water court",
          loadTypes: ["intermittent endurance", "contact", "throwing"],
          competition: "tournament formats with short recovery",
          keyDemands: ["repeat sprint swimming", "physical contests", "tactical awareness"],
          signatureSkills: ["eggbeater kick", "overhead passing", "shot placement"],
          riskProfile: "shoulder load and contact fatigue",
          equipment: "ball, pool, goals",
        },
        {
          name: "Football (Soccer)",
          slug: "football-soccer",
          season: "summer",
          category: "mixed",
          environment: "outdoor grass or turf pitches",
          loadTypes: ["intermittent endurance", "acceleration", "contact"],
          competition: "league season with tournament peaks",
          keyDemands: ["repeated accelerations", "decision making", "technical precision"],
          signatureSkills: ["first touch", "passing under pressure", "positional awareness"],
          riskProfile: "hamstring, groin, and load management risk",
          equipment: "ball, boots, pitch",
        },
        {
          name: "Rugby Sevens",
          slug: "rugby-sevens",
          season: "summer",
          category: "collision",
          environment: "outdoor grass or turf pitches",
          loadTypes: ["speed", "contact", "repeat sprint"],
          competition: "tournament weekends with rapid turnover",
          keyDemands: ["open-field speed", "tackle resilience", "tactical discipline"],
          signatureSkills: ["breakdown efficiency", "offload timing", "spacing"],
          riskProfile: "high collision and fatigue exposure",
          equipment: "ball, boots, pitch",
        },
        {
          name: "Basketball",
          slug: "basketball",
          season: "summer",
          category: "mixed",
          environment: "indoor court",
          loadTypes: ["jump load", "acceleration", "skill"],
          competition: "seasonal leagues with tournament peaks",
          keyDemands: ["explosive changes of direction", "shooting accuracy", "tactical reads"],
          signatureSkills: ["shot creation", "defensive footwork", "ball handling"],
          riskProfile: "ankle, knee, and cumulative load risk",
          equipment: "ball, court, hoops",
        },
        {
          name: "Basketball (3x3)",
          slug: "basketball-3x3",
          season: "summer",
          category: "mixed",
          environment: "outdoor or indoor half-court",
          loadTypes: ["speed", "jump load", "decision making"],
          competition: "short-format games with quick turnovers",
          keyDemands: ["repeat accelerations", "space creation", "shot selection"],
          signatureSkills: ["one-on-one defense", "quick shot creation", "communication"],
          riskProfile: "ankle and knee load with dense schedules",
          equipment: "ball, half-court",
        },
        {
          name: "Gymnastics (Artistic)",
          slug: "gymnastics-artistic",
          season: "summer",
          category: "skill",
          environment: "specialist indoor apparatus halls",
          loadTypes: ["impact", "strength", "flexibility"],
          competition: "routine-based scoring with seasonal peaks",
          keyDemands: ["precision", "body control", "risk management"],
          signatureSkills: ["air awareness", "apparatus timing", "landing mechanics"],
          riskProfile: "high impact and early specialization load",
          equipment: "apparatus set",
        },
        {
          name: "Gymnastics (Rhythmic)",
          slug: "gymnastics-rhythmic",
          season: "summer",
          category: "skill",
          environment: "indoor performance floor",
          loadTypes: ["flexibility", "coordination", "endurance"],
          competition: "routine-based scoring",
          keyDemands: ["apparatus handling", "artistic timing", "precision"],
          signatureSkills: ["ribbon/hoop control", "dance quality", "body alignment"],
          riskProfile: "lumbar, hip, and overuse risk",
          equipment: "hand apparatus",
        },
        {
          name: "Gymnastics (Trampoline)",
          slug: "gymnastics-trampoline",
          season: "summer",
          category: "skill",
          environment: "indoor trampoline arena",
          loadTypes: ["impact", "aerial control", "coordination"],
          competition: "routine-based scoring",
          keyDemands: ["aerial awareness", "landing control", "sequence precision"],
          signatureSkills: ["twist timing", "height control", "spotting"],
          riskProfile: "impact and joint load risk",
          equipment: "trampoline bed",
        },
        {
          name: "Weightlifting",
          slug: "weightlifting",
          season: "summer",
          category: "power",
          environment: "indoor lifting platform",
          loadTypes: ["maximal strength", "power", "technical"],
          competition: "meet-based with peak attempts",
          keyDemands: ["explosive force", "bar path precision", "mobility"],
          signatureSkills: ["snatch timing", "clean and jerk stability", "bracing"],
          riskProfile: "spine, shoulder, and overload risk",
          equipment: "barbell, plates, platform",
        },
        {
          name: "Cycling (Road)",
          slug: "cycling-road",
          season: "summer",
          category: "endurance",
          environment: "outdoor roads",
          loadTypes: ["endurance", "power", "repetition"],
          competition: "staged races with strategic peaks",
          keyDemands: ["aerobic power", "pacing", "tactical positioning"],
          signatureSkills: ["pack handling", "climbing efficiency", "sprint timing"],
          riskProfile: "overuse and crash risk",
          equipment: "road bike",
        },
        {
          name: "Cycling (Track)",
          slug: "cycling-track",
          season: "summer",
          category: "power",
          environment: "indoor or outdoor velodrome",
          loadTypes: ["power", "speed", "repetition"],
          competition: "heat-based sprint and endurance events",
          keyDemands: ["maximal power", "race craft", "track positioning"],
          signatureSkills: ["standing starts", "banked cornering", "team timing"],
          riskProfile: "high speed crash risk",
          equipment: "track bike",
        },
        {
          name: "Cycling (BMX Racing)",
          slug: "cycling-bmx-racing",
          season: "summer",
          category: "power",
          environment: "outdoor BMX track",
          loadTypes: ["power", "impact", "speed"],
          competition: "multi-heat racing",
          keyDemands: ["explosive starts", "jump timing", "bike handling"],
          signatureSkills: ["gate reaction", "pump technique", "corner control"],
          riskProfile: "impact and crash risk",
          equipment: "BMX race bike",
        },
        {
          name: "Cycling (BMX Freestyle)",
          slug: "cycling-bmx-freestyle",
          season: "summer",
          category: "skill",
          environment: "park or street course",
          loadTypes: ["impact", "coordination", "power"],
          competition: "judged trick runs",
          keyDemands: ["air control", "creativity", "precision"],
          signatureSkills: ["trick execution", "landing control", "line flow"],
          riskProfile: "impact and crash risk",
          equipment: "BMX freestyle bike",
        },
        {
          name: "Cycling (Mountain Bike)",
          slug: "cycling-mountain-bike",
          season: "summer",
          category: "endurance",
          environment: "off-road terrain",
          loadTypes: ["endurance", "impact", "power"],
          competition: "lap-based races",
          keyDemands: ["technical handling", "aerobic capacity", "power bursts"],
          signatureSkills: ["line choice", "traction control", "climbing"],
          riskProfile: "impact and overuse risk",
          equipment: "mountain bike",
        },
        {
          name: "Rowing",
          slug: "rowing",
          season: "summer",
          category: "endurance",
          environment: "water courses",
          loadTypes: ["endurance", "power", "repetition"],
          competition: "heat-based regattas",
          keyDemands: ["aerobic power", "stroke efficiency", "crew synchronization"],
          signatureSkills: ["catch timing", "boat balance", "race pacing"],
          riskProfile: "lumbar and rib stress",
          equipment: "boat and oars",
        },
        {
          name: "Canoe Sprint",
          slug: "canoe-sprint",
          season: "summer",
          category: "power",
          environment: "flat water courses",
          loadTypes: ["power", "endurance", "upper body load"],
          competition: "sprint races with heats",
          keyDemands: ["stroke power", "boat control", "race execution"],
          signatureSkills: ["start acceleration", "stroke rhythm", "lane control"],
          riskProfile: "shoulder and trunk load",
          equipment: "canoe or kayak",
        },
        {
          name: "Canoe Slalom",
          slug: "canoe-slalom",
          season: "summer",
          category: "skill",
          environment: "whitewater courses",
          loadTypes: ["power", "skill", "reaction"],
          competition: "timed runs with penalties",
          keyDemands: ["rapid decision making", "boat control", "agility"],
          signatureSkills: ["gate negotiation", "eddy turns", "line selection"],
          riskProfile: "upper limb and collision risk",
          equipment: "canoe or kayak",
        },
        {
          name: "Judo",
          slug: "judo",
          season: "summer",
          category: "collision",
          environment: "indoor tatami",
          loadTypes: ["power", "grip", "contact"],
          competition: "tournament bouts",
          keyDemands: ["grip control", "explosive throws", "tactical timing"],
          signatureSkills: ["kuzushi", "transition speed", "ne-waza control"],
          riskProfile: "joint and contact load",
          equipment: "judogi",
        },
        {
          name: "Boxing",
          slug: "boxing",
          season: "summer",
          category: "collision",
          environment: "indoor ring",
          loadTypes: ["repeat power", "contact", "endurance"],
          competition: "round-based bouts",
          keyDemands: ["strike accuracy", "defensive awareness", "conditioning"],
          signatureSkills: ["footwork", "combo timing", "countering"],
          riskProfile: "head contact and fatigue risk",
          equipment: "gloves, ring",
        },
        {
          name: "Taekwondo",
          slug: "taekwondo",
          season: "summer",
          category: "collision",
          environment: "indoor mat",
          loadTypes: ["power", "speed", "contact"],
          competition: "round-based bouts",
          keyDemands: ["kick speed", "distance control", "tactical reads"],
          signatureSkills: ["spinning kicks", "counter timing", "reach management"],
          riskProfile: "lower limb impact and contact risk",
          equipment: "protective gear",
        },
        {
          name: "Wrestling",
          slug: "wrestling",
          season: "summer",
          category: "collision",
          environment: "indoor mat",
          loadTypes: ["strength", "contact", "grip"],
          competition: "tournament bouts",
          keyDemands: ["positional control", "explosive takedowns", "conditioning"],
          signatureSkills: ["hand fighting", "mat returns", "scramble ability"],
          riskProfile: "joint and contact load",
          equipment: "wrestling mat",
        },
        {
          name: "Tennis",
          slug: "tennis",
          season: "summer",
          category: "skill",
          environment: "outdoor or indoor courts",
          loadTypes: ["repeat sprint", "upper body load", "skill"],
          competition: "tournament circuits",
          keyDemands: ["serve effectiveness", "movement efficiency", "mental resilience"],
          signatureSkills: ["shot selection", "rally control", "footwork"],
          riskProfile: "shoulder, elbow, and ankle risk",
          equipment: "racquet, court",
        },
        {
          name: "Field Hockey",
          slug: "field-hockey",
          season: "summer",
          category: "mixed",
          environment: "outdoor turf pitch",
          loadTypes: ["intermittent endurance", "skill", "speed"],
          competition: "tournament-based",
          keyDemands: ["stick control", "repeat acceleration", "tactical spacing"],
          signatureSkills: ["dribbling under pressure", "passing speed", "pressing"],
          riskProfile: "lower limb and stick impact risk",
          equipment: "stick, ball",
        },
        {
          name: "Volleyball (Indoor)",
          slug: "volleyball-indoor",
          season: "summer",
          category: "skill",
          environment: "indoor court",
          loadTypes: ["jump load", "reaction", "skill"],
          competition: "set-based matches",
          keyDemands: ["jump power", "serve precision", "team coordination"],
          signatureSkills: ["block timing", "attack approach", "defensive coverage"],
          riskProfile: "ankle and shoulder load",
          equipment: "ball, court",
        },
        {
          name: "Volleyball (Beach)",
          slug: "volleyball-beach",
          season: "summer",
          category: "endurance",
          environment: "outdoor sand courts",
          loadTypes: ["jump load", "endurance", "heat"],
          competition: "tournament circuits",
          keyDemands: ["movement in sand", "serve pressure", "partner coordination"],
          signatureSkills: ["ball control", "block-read", "all-around play"],
          riskProfile: "shoulder and heat stress",
          equipment: "ball, sand court",
        },
        {
          name: "Triathlon",
          slug: "triathlon",
          season: "summer",
          category: "endurance",
          environment: "open water, road, and running courses",
          loadTypes: ["endurance", "heat", "transition"],
          competition: "multi-discipline races with peak events",
          keyDemands: ["aerobic efficiency", "transition speed", "pacing"],
          signatureSkills: ["swim-bike-run balance", "transition setup", "hydration"],
          riskProfile: "multi-discipline overuse risk",
          equipment: "bike, swim gear",
        },
        {
          name: "Modern Pentathlon",
          slug: "modern-pentathlon",
          season: "summer",
          category: "mixed",
          environment: "multi-venue",
          loadTypes: ["endurance", "skill", "precision"],
          competition: "multi-event format with combined final",
          keyDemands: ["event switching", "mental control", "shoot-run pacing"],
          signatureSkills: ["fencing timing", "riding control", "transition management"],
          riskProfile: "cumulative fatigue risk",
          equipment: "varied event gear",
        },
        {
          name: "Shooting",
          slug: "shooting",
          season: "summer",
          category: "skill",
          environment: "indoor or outdoor ranges",
          loadTypes: ["precision", "static load", "focus"],
          competition: "qualification and finals",
          keyDemands: ["fine motor control", "breathing regulation", "focus"],
          signatureSkills: ["trigger control", "sight alignment", "shot routine"],
          riskProfile: "postural fatigue and mental load",
          equipment: "firearm, range",
        },
        {
          name: "Archery",
          slug: "archery",
          season: "summer",
          category: "skill",
          environment: "indoor or outdoor ranges",
          loadTypes: ["precision", "static strength", "focus"],
          competition: "qualification and head-to-head matches",
          keyDemands: ["draw control", "aiming stability", "mental discipline"],
          signatureSkills: ["release timing", "shot sequence", "wind management"],
          riskProfile: "shoulder load and postural fatigue",
          equipment: "bow, arrows",
        },
        {
          name: "Equestrian",
          slug: "equestrian",
          season: "summer",
          category: "skill",
          environment: "outdoor or indoor arenas",
          loadTypes: ["coordination", "balance", "risk management"],
          competition: "eventing, dressage, and jumping formats",
          keyDemands: ["horse-athlete communication", "rhythm control", "course management"],
          signatureSkills: ["aids timing", "jump approach", "precision lines"],
          riskProfile: "fall risk and asymmetrical load",
          equipment: "horse and tack",
        },
        {
          name: "Golf",
          slug: "golf",
          season: "summer",
          category: "skill",
          environment: "outdoor course",
          loadTypes: ["skill", "walking endurance", "precision"],
          competition: "multi-round tournaments",
          keyDemands: ["swing consistency", "shot planning", "mental patience"],
          signatureSkills: ["club selection", "short game", "course management"],
          riskProfile: "lumbar and overuse risk",
          equipment: "clubs, course",
        },
        {
          name: "Surfing",
          slug: "surfing",
          season: "summer",
          category: "skill",
          environment: "ocean surf",
          loadTypes: ["upper body endurance", "balance", "reaction"],
          competition: "heat-based events",
          keyDemands: ["wave selection", "paddling endurance", "board control"],
          signatureSkills: ["pop-up speed", "turn execution", "flow"],
          riskProfile: "shoulder and impact risk",
          equipment: "surfboard",
        },
        {
          name: "Sport Climbing",
          slug: "sport-climbing",
          season: "summer",
          category: "skill",
          environment: "indoor climbing walls",
          loadTypes: ["grip endurance", "power", "technique"],
          competition: "combined bouldering, lead, speed",
          keyDemands: ["route reading", "finger strength", "body tension"],
          signatureSkills: ["movement efficiency", "dyno control", "pace management"],
          riskProfile: "finger and shoulder load",
          equipment: "climbing shoes, wall",
        },
        {
          name: "Skateboarding",
          slug: "skateboarding",
          season: "summer",
          category: "skill",
          environment: "park and street courses",
          loadTypes: ["impact", "coordination", "precision"],
          competition: "run-based judging",
          keyDemands: ["trick execution", "creativity", "consistency"],
          signatureSkills: ["board control", "landing mechanics", "line flow"],
          riskProfile: "impact and fall risk",
          equipment: "skateboard",
        },
        {
          name: "Breaking",
          slug: "breaking",
          season: "summer",
          category: "skill",
          environment: "indoor performance stage",
          loadTypes: ["power", "coordination", "endurance"],
          competition: "battle format",
          keyDemands: ["musicality", "power moves", "creativity"],
          signatureSkills: ["freeze control", "footwork complexity", "flow"],
          riskProfile: "shoulder and wrist load",
          equipment: "performance surface",
        },
        {
          name: "Sailing",
          slug: "sailing",
          season: "summer",
          category: "endurance",
          environment: "open water",
          loadTypes: ["endurance", "strength", "environmental load"],
          competition: "series of races with cumulative scoring",
          keyDemands: ["wind reading", "boat handling", "tactical decisions"],
          signatureSkills: ["trim control", "start timing", "course strategy"],
          riskProfile: "overuse and environmental exposure",
          equipment: "sailboat",
        },
        {
          name: "Handball",
          slug: "handball",
          season: "summer",
          category: "collision",
          environment: "indoor court",
          loadTypes: ["power", "contact", "repeated sprint"],
          competition: "tournament format",
          keyDemands: ["jump shots", "defensive contact", "fast transitions"],
          signatureSkills: ["throwing velocity", "defensive footwork", "spacing"],
          riskProfile: "shoulder and knee load",
          equipment: "ball, court",
        },
        {
          name: "Badminton",
          slug: "badminton",
          season: "summer",
          category: "skill",
          environment: "indoor court",
          loadTypes: ["reaction", "speed", "endurance"],
          competition: "tournament circuits",
          keyDemands: ["quick change of direction", "shot variety", "anticipation"],
          signatureSkills: ["net play", "jump smash", "footwork"],
          riskProfile: "knee and shoulder load",
          equipment: "racquet, shuttle",
        },
        {
          name: "Table Tennis",
          slug: "table-tennis",
          season: "summer",
          category: "skill",
          environment: "indoor hall",
          loadTypes: ["reaction", "precision", "coordination"],
          competition: "match play tournaments",
          keyDemands: ["spin control", "anticipation", "fine motor precision"],
          signatureSkills: ["serve variation", "rally tempo", "footwork"],
          riskProfile: "overuse and visual fatigue",
          equipment: "table, bat",
        },
        {
          name: "Baseball/Softball",
          slug: "baseball-softball",
          season: "summer",
          category: "skill",
          environment: "outdoor field",
          loadTypes: ["throwing", "skill", "power"],
          competition: "tournament format",
          keyDemands: ["bat control", "throwing precision", "game awareness"],
          signatureSkills: ["pitching mechanics", "fielding reactions", "plate discipline"],
          riskProfile: "shoulder and elbow load",
          equipment: "bat, glove, ball",
        },
        {
          name: "Fencing",
          slug: "fencing",
          season: "summer",
          category: "skill",
          environment: "indoor piste",
          loadTypes: ["reaction", "speed", "precision"],
          competition: "pool rounds and knockout bouts",
          keyDemands: ["distance control", "reaction speed", "tactical deception"],
          signatureSkills: ["lunge timing", "parry-riposte", "blade control"],
          riskProfile: "lower limb and overuse risk",
          equipment: "weapon and protective gear",
        },
        {
          name: "Alpine Skiing",
          slug: "alpine-skiing",
          season: "winter",
          category: "power",
          environment: "snow slopes",
          loadTypes: ["power", "impact", "speed"],
          competition: "race runs with seasonal peaks",
          keyDemands: ["edge control", "high-speed decision making", "leg strength"],
          signatureSkills: ["carving precision", "line choice", "start explosiveness"],
          riskProfile: "knee and impact risk",
          equipment: "skis and protective gear",
        },
        {
          name: "Nordic Skiing (Cross-Country / Ski Jumping / Nordic Combined)",
          slug: "nordic-skiing",
          season: "winter",
          category: "endurance",
          environment: "snow trails and jumps",
          loadTypes: ["endurance", "power", "technical"],
          competition: "distance races and judged jumps",
          keyDemands: ["aerobic capacity", "technique", "jump timing"],
          signatureSkills: ["ski efficiency", "pole timing", "aerial control"],
          riskProfile: "overuse and impact risk",
          equipment: "skis, poles",
        },
        {
          name: "Snowboarding",
          slug: "snowboarding",
          season: "winter",
          category: "skill",
          environment: "snow parks and halfpipes",
          loadTypes: ["impact", "coordination", "power"],
          competition: "run-based judged events",
          keyDemands: ["board control", "aerial awareness", "style"],
          signatureSkills: ["edge transitions", "trick execution", "landing control"],
          riskProfile: "impact and fall risk",
          equipment: "snowboard",
        },
        {
          name: "Ice Hockey",
          slug: "ice-hockey",
          season: "winter",
          category: "collision",
          environment: "indoor ice rink",
          loadTypes: ["speed", "contact", "skill"],
          competition: "seasonal league and tournament",
          keyDemands: ["skating speed", "puck control", "contact resilience"],
          signatureSkills: ["edge work", "shooting under pressure", "line changes"],
          riskProfile: "contact and speed collision risk",
          equipment: "skates, stick, protective gear",
        },
        {
          name: "Speed Skating",
          slug: "speed-skating",
          season: "winter",
          category: "power",
          environment: "indoor ice oval",
          loadTypes: ["power", "endurance", "technique"],
          competition: "time-based races",
          keyDemands: ["lap speed", "aerobic power", "corner technique"],
          signatureSkills: ["glide efficiency", "start timing", "race pacing"],
          riskProfile: "lower limb overuse risk",
          equipment: "speed skates",
        },
        {
          name: "Short Track Speed Skating",
          slug: "short-track-speed-skating",
          season: "winter",
          category: "collision",
          environment: "indoor ice rink",
          loadTypes: ["speed", "tactical positioning", "contact"],
          competition: "heat-based racing",
          keyDemands: ["pack tactics", "explosive starts", "balance"],
          signatureSkills: ["cornering", "passing", "reaction"],
          riskProfile: "collision and fall risk",
          equipment: "short track skates",
        },
        {
          name: "Figure Skating",
          slug: "figure-skating",
          season: "winter",
          category: "skill",
          environment: "indoor ice rink",
          loadTypes: ["impact", "coordination", "artistry"],
          competition: "short and free programs",
          keyDemands: ["jump precision", "spin control", "presentation"],
          signatureSkills: ["takeoff timing", "landing control", "musicality"],
          riskProfile: "impact and overuse risk",
          equipment: "figure skates",
        },
        {
          name: "Biathlon",
          slug: "biathlon",
          season: "winter",
          category: "endurance",
          environment: "snow trails and shooting range",
          loadTypes: ["endurance", "precision", "cold exposure"],
          competition: "race formats with shooting bouts",
          keyDemands: ["aerobic capacity", "calm under fatigue", "shot accuracy"],
          signatureSkills: ["ski-shoot transitions", "breathing control", "penalty management"],
          riskProfile: "cold stress and overuse risk",
          equipment: "skis, rifle",
        },
        {
          name: "Bobsleigh",
          slug: "bobsleigh",
          season: "winter",
          category: "power",
          environment: "ice track",
          loadTypes: ["power", "speed", "impact"],
          competition: "multi-run timed races",
          keyDemands: ["start push power", "crew synchronization", "high-speed control"],
          signatureSkills: ["push timing", "loading precision", "steering"],
          riskProfile: "impact and crash risk",
          equipment: "sled",
        },
        {
          name: "Luge",
          slug: "luge",
          season: "winter",
          category: "skill",
          environment: "ice track",
          loadTypes: ["speed", "precision", "reaction"],
          competition: "timed runs",
          keyDemands: ["start technique", "line control", "nerve management"],
          signatureSkills: ["steering subtlety", "start pull", "track memory"],
          riskProfile: "high-speed crash risk",
          equipment: "sled",
        },
        {
          name: "Skeleton",
          slug: "skeleton",
          season: "winter",
          category: "power",
          environment: "ice track",
          loadTypes: ["speed", "impact", "power"],
          competition: "timed runs",
          keyDemands: ["start sprint", "aerodynamic control", "fear management"],
          signatureSkills: ["push-start", "steering", "body position"],
          riskProfile: "high-speed crash risk",
          equipment: "sled",
        },
        {
          name: "Curling",
          slug: "curling",
          season: "winter",
          category: "skill",
          environment: "indoor ice rink",
          loadTypes: ["precision", "control", "team strategy"],
          competition: "round-robin and playoff draws",
          keyDemands: ["shot execution", "team communication", "strategy"],
          signatureSkills: ["stone release", "sweeping timing", "line calling"],
          riskProfile: "knee and lumbar load",
          equipment: "stones and brooms",
        },
        {
          name: "Freestyle Skiing",
          slug: "freestyle-skiing",
          season: "winter",
          category: "skill",
          environment: "snow parks and courses",
          loadTypes: ["impact", "power", "coordination"],
          competition: "run-based judged events",
          keyDemands: ["aerial control", "landing mechanics", "creativity"],
          signatureSkills: ["trick combos", "line choice", "speed control"],
          riskProfile: "impact and fall risk",
          equipment: "freestyle skis",
        },
        {
          name: "Nordic Combined",
          slug: "nordic-combined",
          season: "winter",
          category: "endurance",
          environment: "snow trails and jumps",
          loadTypes: ["endurance", "power", "technical"],
          competition: "jump + cross-country combined",
          keyDemands: ["aerobic capacity", "jump precision", "pacing"],
          signatureSkills: ["takeoff timing", "ski efficiency", "transition control"],
          riskProfile: "overuse and impact risk",
          equipment: "skis, poles",
        },
        {
          name: "Cross-Country Skiing",
          slug: "cross-country-skiing",
          season: "winter",
          category: "endurance",
          environment: "snow trails",
          loadTypes: ["endurance", "power", "technique"],
          competition: "distance races and sprints",
          keyDemands: ["aerobic power", "technique", "pacing"],
          signatureSkills: ["classic/skating efficiency", "climbing", "drafting"],
          riskProfile: "overuse and cold exposure",
          equipment: "skis, poles",
        },
        {
          name: "Ski Jumping",
          slug: "ski-jumping",
          season: "winter",
          category: "skill",
          environment: "ski jump hill",
          loadTypes: ["impact", "precision", "aerial control"],
          competition: "jump rounds",
          keyDemands: ["takeoff precision", "flight control", "landing balance"],
          signatureSkills: ["in-run posture", "flight stability", "telemark landing"],
          riskProfile: "impact and fall risk",
          equipment: "jump skis",
        }
      ];

      const summerSports = sports.filter((sport) => sport.season === "summer");
      const winterSports = sports.filter((sport) => sport.season === "winter");
      const sportBySlug = new Map(sports.map((sport) => [sport.slug, sport]));

      const pillarKeys = [
        "psychological",
        "physical",
        "technical",
        "tactical",
        "sleep",
        "nutrition",
        "health",
        "environment",
      ];

      const pillarTitles = {
        psychological: "Psychological Performance",
        physical: "Physical Capacity & Movement",
        technical: "Technical Skill",
        tactical: "Tactical / Game Sense",
        sleep: "Sleep & Recovery",
        nutrition: "Nutrition & Hydration",
        health: "Health, Load & Injury Management",
        environment: "Environment & Context",
      };

      const pillarDescriptions = {
        psychological: "Control attention and emotion when it matters most.",
        physical: "Build capacity and movement quality that survives volume.",
        technical: "Repeat skill under pressure with clean execution.",
        tactical: "Make better decisions faster - especially under fatigue.",
        sleep: "Recover like it is training: consistency, not perfection.",
        nutrition: "Fuel, hydrate, and time intake for stable energy.",
        health: "Manage load and injury risk with smarter signals.",
        environment: "Align support, culture, and context around performance.",
      };

      const movementTasks = [
        "Deep Squat",
        "Single Leg Balance Reach",
        "Forward Lunge",
        "Push Up Pattern",
        "Overhead Reach & Rotation",
        "Change of Direction Step",
      ];

      const baseByCategory = {
        endurance: { mean: 70, sd: 12 },
        power: { mean: 72, sd: 11 },
        skill: { mean: 68, sd: 10 },
        collision: { mean: 69, sd: 12 },
        mixed: { mean: 71, sd: 11 },
      };

      const movementByCategory = {
        endurance: { mean: 22, sd: 3 },
        power: { mean: 24, sd: 2.5 },
        skill: { mean: 20, sd: 3 },
        collision: { mean: 23, sd: 2.8 },
        mixed: { mean: 21.5, sd: 3 },
      };

      const stageAdjustments = {
        developing: -4,
        performance: 0,
      };

      const sleepOptimal = {
        developing: 9,
        performance: 8,
      };

      const buildNormProfile = (sport) => {
        const base = baseByCategory[sport.category];
        const movement = movementByCategory[sport.category];
        const pillars = pillarKeys.reduce((acc, key) => {
          const envBoost = key === "environment" && sport.environment.includes("outdoor") ? 2 : 0;
          const healthBoost = key === "health" && sport.category === "collision" ? 3 : 0;
          acc[key] = { mean: base.mean + envBoost + healthBoost, sd: base.sd };
          return acc;
        }, {});
        return { sleepOptimal, movement, pillars };
      };

      const normsBySport = new Map(sports.map((sport) => [sport.slug, buildNormProfile(sport)]));

      const templateQuestion = (input, sport) => {
        const joinList = (items) => items.slice(0, 2).join(" and ");
        return input
          .replaceAll("{sport}", sport.name)
          .replaceAll("{demand}", joinList(sport.keyDemands))
          .replaceAll("{skill}", joinList(sport.signatureSkills))
          .replaceAll("{environment}", sport.environment)
          .replaceAll("{equipment}", sport.equipment)
          .replaceAll("{risk}", sport.riskProfile);
      };

      const buildPillarsForSport = (sport) => [
        {
          key: "psychological",
          title: pillarTitles.psychological,
          subdomains: [
            {
              title: "Focus & Attention",
              questions: [
                "In {sport}, I stay locked in during {demand} phases.",
                "My attention stays steady when routines shift in {environment}.",
              ],
            },
            {
              title: "Emotional Regulation",
              questions: [
                "After errors, I reset quickly and return to {skill} execution.",
                "Pressure moments improve my decision making in {sport}.",
              ],
            },
            {
              title: "Confidence & Motivation",
              questions: [
                "I trust my preparation to deliver {skill} when it matters.",
                "I sustain motivation through heavy training blocks.",
              ],
            },
          ],
        },
        {
          key: "physical",
          title: pillarTitles.physical,
          subdomains: [
            {
              title: "Energy & Work Capacity",
              questions: [
                "I can repeatedly meet the {demand} demands of {sport}.",
                "My conditioning supports quality execution late in competition.",
              ],
            },
            {
              title: "Strength & Mobility",
              questions: [
                "My strength profile supports safe use of {equipment}.",
                "My mobility allows efficient positions needed for {skill}.",
              ],
            },
            {
              title: "Movement Quality",
              questions: [
                "I move efficiently in {environment} without avoidable strain.",
                "I can stabilize and decelerate under {demand} load.",
              ],
            },
          ],
        },
        {
          key: "technical",
          title: pillarTitles.technical,
          subdomains: [
            {
              title: "Execution",
              questions: [
                "My {skill} execution is reliable under match pressure.",
                "I can reproduce precise technique across varied conditions.",
              ],
            },
            {
              title: "Consistency",
              questions: [
                "I can repeat technical actions with minimal drop-off.",
                "I adapt technique when {environment} or tempo changes.",
              ],
            },
            {
              title: "Skill Under Fatigue",
              questions: [
                "My technique remains stable during {demand} fatigue.",
                "I protect quality while training volume rises.",
              ],
            },
          ],
        },
        {
          key: "tactical",
          title: pillarTitles.tactical,
          subdomains: [
            {
              title: "Decision Making",
              questions: [
                "I choose effective options quickly in {sport} contexts.",
                "I recognize cues that shape {demand} patterns.",
              ],
            },
            {
              title: "Positioning & Timing",
              questions: [
                "My timing supports efficient use of {skill}.",
                "I position myself to reduce unnecessary {risk} exposure.",
              ],
            },
            {
              title: "Adaptation",
              questions: [
                "I adjust tactics when competition pace changes.",
                "I can switch strategy based on opponent or conditions.",
              ],
            },
          ],
        },
        {
          key: "sleep",
          title: pillarTitles.sleep,
          subdomains: [
            {
              title: "Sleep Quality",
              questions: [
                "I wake feeling restored for {demand} training days.",
                "My sleep routine stays consistent during travel or tournaments.",
              ],
            },
            {
              title: "Recovery Habits",
              questions: [
                "I actively plan recovery to protect {skill} quality.",
                "I prioritize recovery when load or {risk} increases.",
              ],
            },
          ],
        },
        {
          key: "nutrition",
          title: pillarTitles.nutrition,
          subdomains: [
            {
              title: "Fueling",
              questions: [
                "My daily fueling supports the {demand} demands of {sport}.",
                "I adjust intake for heavy training or double sessions.",
              ],
            },
            {
              title: "Hydration",
              questions: [
                "I monitor hydration during long sessions in {environment}.",
                "I have a plan for competition-day fluid intake.",
              ],
            },
            {
              title: "Competition Strategy",
              questions: [
                "My race or match-day nutrition keeps energy stable.",
                "I recover with a plan after intense competition blocks.",
              ],
            },
          ],
        },
        {
          key: "health",
          title: pillarTitles.health,
          subdomains: [
            {
              title: "Load Awareness",
              questions: [
                "I track workload to reduce {risk} exposure.",
                "I communicate early signs of overload.",
              ],
            },
            {
              title: "Injury Prevention",
              questions: [
                "I complete targeted prevention work for {sport} risks.",
                "I prioritize warm-up and cool-down quality.",
              ],
            },
            {
              title: "Medical & Support",
              questions: [
                "I know how to access physio or medical support quickly.",
                "My screening data informs my training choices.",
              ],
            },
          ],
        },
        {
          key: "environment",
          title: pillarTitles.environment,
          subdomains: [
            {
              title: "Support Network",
              questions: [
                "My coaching and support team align on performance goals.",
                "I receive feedback that sharpens {skill} execution.",
              ],
            },
            {
              title: "Facilities & Travel",
              questions: [
                "I have reliable access to {environment} training resources.",
                "Travel demands are planned to protect recovery.",
              ],
            },
            {
              title: "Culture & Mindset",
              questions: [
                "Our environment reinforces performance habits.",
                "The training culture supports long-term development.",
              ],
            },
          ],
        },
      ].map((pillar) => ({
        ...pillar,
        subdomains: pillar.subdomains.map((sub) => ({
          ...sub,
          questions: sub.questions.map((q) => templateQuestion(q, sport)),
        })),
      }));

      const buildPillarExplanations = (sport) => ({
        psychological: `Focus and emotional control keep ${sport.name} athletes calm while executing ${sport.signatureSkills[0]} under ${sport.keyDemands[0]} stress.`,
        physical: `Physical capacity supports repeated ${sport.loadTypes.join(", ")} efforts and movement quality required for ${sport.signatureSkills[0]}.`,
        technical: `Technical skill quality differentiates performance in ${sport.name} because ${sport.signatureSkills.join(", ")} must stay precise in changing conditions.`,
        tactical: `Tactical awareness guides pacing and decision making across ${sport.competition} formats and reduces ${sport.riskProfile}.`,
        sleep: `Sleep and recovery protect adaptation from ${sport.loadTypes.join(", ")} training while maintaining readiness for ${sport.environment} demands.`,
        nutrition: `Nutrition and hydration sustain energy for ${sport.keyDemands.join(", ")} and support resilience during travel or tournaments.`,
        health: `Health and load management target ${sport.riskProfile} while ensuring training volume is sustainable.`,
        environment: `Environment and context shape access to ${sport.environment} resources and the coaching support needed to refine ${sport.signatureSkills[0]}.`,
      });

      const buildTrackingNarrative = (sport) => {
        const base = `Tracking development in ${sport.name} aligns training phases with ${sport.competition} and protects long-term progress.`;
        const categoryNotes = {
          endurance: "Endurance-focused sports need careful monitoring of aerobic load, cumulative fatigue, and multi-peak season planning.",
          power: "Power sports demand close tracking of readiness, neuromuscular freshness, and technical sharpness during peak attempts.",
          skill: "Skill-dominant sports rely on consistent technical feedback, early specialization risk management, and protection against burnout.",
          collision: "Collision sports require injury risk monitoring, contact load management, and recovery strategies between dense competitions.",
          mixed: "Mixed-demand sports need balanced tracking of energy systems, skill execution, and tactical learning across the season.",
        };
        return [
          base,
          categoryNotes[sport.category],
          `Youth and developing athletes should monitor maturation, growth-related load shifts, and motivation in ${sport.name}.`,
          `Performance athletes benefit from tracking readiness signals to peak for key events and reduce ${sport.riskProfile}.`,
        ];
      };

      const clamp = (value, min, max) => Math.min(max, Math.max(min, value));
      const likertToPercent = (value) => clamp(((value - 1) / 4) * 100, 0, 100);

      const erf = (x) => {
        const sign = x >= 0 ? 1 : -1;
        const a1 = 0.254829592;
        const a2 = -0.284496736;
        const a3 = 1.421413741;
        const a4 = -1.453152027;
        const a5 = 1.061405429;
        const p = 0.3275911;
        const absX = Math.abs(x);
        const t = 1 / (1 + p * absX);
        const y = 1 - ((((a5 * t + a4) * t + a3) * t + a2) * t + a1) * t * Math.exp(-absX * absX);
        return sign * y;
      };

      const normalCdf = (x) => 0.5 * (1 + erf(x / Math.sqrt(2)));
      const zToPercentile = (z) => clamp(normalCdf(z) * 100, 1, 99);

      const bandFromPercentile = (percentile) => {
        if (percentile < 25) return "Low";
        if (percentile < 50) return "Average";
        if (percentile < 75) return "Above Average";
        return "High";
      };

      const scoreSleep = (hours, optimal) => {
        const delta = Math.abs(hours - optimal);
        return clamp(100 - delta * 12.5, 0, 100);
      };

      const scoreMovement = (scores) => {
        const total = scores.reduce((sum, value) => sum + value, 0);
        const max = scores.length * 5;
        return clamp((total / max) * 100, 0, 100);
      };

      const getSubdomainScores = (pillars) => {
        return pillars
          .filter((pillar) => pillar.key !== "sleep")
          .flatMap((pillar) =>
            pillar.subdomains.map((sub, subIndex) => {
              const values = sub.questions
                .map((_question, questionIndex) => {
                  const id = buildQuestionId(pillar.key, subIndex, questionIndex);
                  return state.responses[id] || 0;
                })
                .filter((value) => value > 0);
              const avg = values.length
                ? values.reduce((sum, value) => sum + value, 0) / values.length
                : 0;
              return {
                pillarKey: pillar.key,
                pillarTitle: pillar.title,
                subdomainTitle: sub.title,
                score: likertToPercent(avg),
              };
            })
          );
      };

      const state = {
        selectedSport: "",
        stage: "developing",
        age: "",
        responses: {},
        movementScores: movementTasks.map((task) => ({ task, score: 3 })),
        sleepHours: 8,
        lastResults: null,
      };

      const app = document.getElementById("app");
      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

      const bindScrollReveal = () => {
        if (prefersReducedMotion) {
          document.querySelectorAll(".reveal").forEach((el) => el.classList.add("is-visible"));
          return;
        }
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                entry.target.classList.add("is-visible");
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.15 }
        );
        document.querySelectorAll(".reveal").forEach((el) => observer.observe(el));
      };

      const bindWheelInteractions = () => {
        const nodes = document.querySelectorAll(".wheel-node");
        const modal = document.getElementById("pillar-modal");
        const modalTitle = document.getElementById("modal-title");
        const modalBody = document.getElementById("modal-body");
        const modalClose = document.getElementById("modal-close");

        const openModal = (key) => {
          if (!modal || !modalTitle || !modalBody) return;
          modalTitle.textContent = pillarTitles[key];
          modalBody.textContent = pillarDescriptions[key];
          modal.classList.add("is-open");
          modalClose?.focus();
        };

        const closeModal = () => {
          if (!modal) return;
          modal.classList.remove("is-open");
        };

        nodes.forEach((node) => {
          node.addEventListener("click", () => openModal(node.dataset.pillar));
          node.addEventListener("keydown", (event) => {
            if (event.key === "Enter" || event.key === " ") {
              event.preventDefault();
              node.click();
            }
          });
        });

        modalClose?.addEventListener("click", closeModal);
        modal?.addEventListener("click", (event) => {
          if (event.target === modal) {
            closeModal();
          }
        });
        document.addEventListener("keydown", (event) => {
          if (event.key === "Escape") {
            closeModal();
          }
        });
      };

      const route = () => {
        const hash = window.location.hash.replace("#", "");
        if (hash.startsWith("/sport/")) {
          const slug = hash.split("/sport/")[1];
          renderSportPage(slug);
        } else if (hash.startsWith("/results/")) {
          const slug = hash.split("/results/")[1];
          renderResultsPage(slug);
        } else {
          renderLanding();
        }
      };

      const renderLanding = () => {
        app.innerHTML = `
          <section class="hero hero--landing reveal">
            <div class="grid two">
              <div class="intro-block">
                <span class="badge">Olympic Institute Framework</span>
                <h1>Better readiness. Better performance.</h1>
                <p>
                  Integrated profiling that turns sport demands into coachable actions.
                  Build a complete performance picture across the eight pillars.
                </p>
              </div>
              <div class="card" id="sport-selector">
                <h3>Select your sport</h3>
                <p>Choose a sport to launch the assessment and generate a norm-referenced report.</p>
                <div class="controls" style="margin-top: 16px;">
                  <select id="sport-select">
                    <option value="">Select your sport</option>
                    <optgroup label="Summer Olympics">
                      ${summerSports.map((sport) => `<option value="${sport.slug}">${sport.name}</option>`).join("")}
                    </optgroup>
                    <optgroup label="Winter Olympics">
                      ${winterSports.map((sport) => `<option value="${sport.slug}">${sport.name}</option>`).join("")}
                    </optgroup>
                  </select>
                  <button id="start-btn" type="button">Begin Assessment</button>
                </div>
              </div>
            </div>
            <div class="stats-strip">
              <div class="stat">
                <strong>8 pillars</strong>
                <span>System-level performance model</span>
              </div>
              <div class="stat">
                <strong>${sports.length} sports</strong>
                <span>Summer and Winter Olympic events</span>
              </div>
              <div class="stat">
                <strong>4 bands</strong>
                <span>Norm-referenced performance signals</span>
              </div>
            </div>
          </section>

          <section class="section reveal">
            <div class="wheel-section">
              <div class="intro-block">
                <h2>The eight pillars of performance</h2>
                <p>Better performance starts with the whole system. Explore each pillar to see what it means.</p>
              </div>
              <div class="wheel-wrap">
                <div class="wheel" aria-hidden="true"></div>
                <div class="wheel-center">Performance<br />System</div>
                ${pillarKeys
                  .map(
                    (key, index) => `
                  <button
                    class="wheel-node"
                    type="button"
                    style="--angle:${index * 45}deg"
                    data-pillar="${key}"
                    aria-haspopup="dialog"
                    aria-controls="pillar-modal"
                    aria-describedby="pillar-tooltip-${key}"
                  >
                    ${pillarTitles[key].split(" ")[0]}
                    <span class="tooltip" id="pillar-tooltip-${key}" role="tooltip">${pillarDescriptions[key]}</span>
                  </button>
                `
                  )
                  .join("")}
              </div>
            </div>
          </section>

          <div class="modal" id="pillar-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title">
            <div class="modal-card">
              <h3 id="modal-title">Pillar Focus</h3>
              <p id="modal-body">Details</p>
              <div class="modal-actions">
                <button class="secondary" type="button" id="modal-close">Close</button>
              </div>
            </div>
          </div>

          <footer class="reveal">
            Integrated Sport Performance Assessment is designed for athlete and coach collaboration. Data is stored locally in-browser for this MVP.
          </footer>
        `;

        const select = document.getElementById("sport-select");
        const btn = document.getElementById("start-btn");
        select.value = state.selectedSport;
        select.addEventListener("change", (event) => {
          state.selectedSport = event.target.value;
        });
        btn.addEventListener("click", () => {
          if (state.selectedSport) {
            window.location.hash = `/sport/${state.selectedSport}`;
          }
        });

        bindWheelInteractions();
        bindScrollReveal();
      };

      const buildQuestionId = (pillarKey, subIndex, questionIndex) => `${pillarKey}-${subIndex}-${questionIndex}`;

      const renderSportPage = (slug) => {
        const sport = sportBySlug.get(slug);
        if (!sport) {
          app.innerHTML = `
            <section class="section">
              <div class="card">
                <h2>Sport not found</h2>
                <p>Please return to the landing page and select a sport.</p>
                <button id="back-home" type="button">Back to Home</button>
              </div>
            </section>
          `;
          document.getElementById("back-home").addEventListener("click", () => {
            window.location.hash = "";
          });
          return;
        }

        state.selectedSport = slug;

        const pillars = buildPillarsForSport(sport);
        const pillarExplanations = buildPillarExplanations(sport);
        const trackingNarrative = buildTrackingNarrative(sport);
        const norms = normsBySport.get(sport.slug);

        const overview = {
          description: `${sport.name} demands ${sport.keyDemands.join(", ")} within ${sport.environment}.`,
          loadTypes: sport.loadTypes.join(", "),
          competition: sport.competition,
        };

        app.innerHTML = `
          <section class="hero">
            <div class="card">
              <span class="badge">${sport.season.toUpperCase()} OLYMPICS</span>
              <h1>${sport.name}</h1>
              <p>${overview.description}</p>
              <div class="controls" style="margin-top: 16px;">
                <div>
                  <label for="age">Age</label>
                  <input id="age" type="number" min="8" max="60" value="${state.age}" />
                </div>
                <div>
                  <label for="stage">Athlete stage</label>
                  <select id="stage">
                    <option value="developing">Developing</option>
                    <option value="performance">Performance/Elite</option>
                  </select>
                </div>
                <button id="change-sport" class="secondary" type="button">Change Sport</button>
              </div>
            </div>
          </section>

          <section class="section">
            <div class="grid three">
              <div class="card">
                <h3>Performance Demands</h3>
                <p>${overview.description}</p>
              </div>
              <div class="card">
                <h3>Dominant Load Types</h3>
                <p>${overview.loadTypes}</p>
              </div>
              <div class="card">
                <h3>Competitive Structure</h3>
                <p>${overview.competition}</p>
              </div>
            </div>
          </section>

          <section class="section">
            <h2>Why the 8 Pillars Matter for ${sport.name}</h2>
            <div class="grid two">
              ${pillarKeys
                .map(
                  (key) => `
                <div class="pillar-card">
                  <h4>${pillarTitles[key]}</h4>
                  <p>${pillarExplanations[key]}</p>
                </div>
              `
                )
                .join("")}
            </div>
          </section>

          <section class="section">
            <h2>Why Tracking Development Matters</h2>
            <div class="grid two">
              ${trackingNarrative.map((item) => `<div class="pillar-card"><p>${item}</p></div>`).join("")}
            </div>
          </section>

          <section class="section">
            <h2>Performance Assessment Module</h2>
            ${pillars
              .filter((pillar) => pillar.key !== "sleep")
              .map((pillar) => renderPillarSection(pillar))
              .join("")}

            ${renderMovementSection()}

            ${renderSleepModule(norms)}

            ${renderPillarSection(pillars.find((pillar) => pillar.key === "sleep"))}

            <div class="card" style="margin-bottom: 20px;">
              <h3>Norm-Referenced Movement Benchmark</h3>
              <p id="movement-benchmark">Movement screen percentile: --</p>
            </div>

            <div class="controls">
              <button id="results-btn" type="button">Generate Results Dashboard</button>
            </div>
          </section>

          
        `;

        const stageSelect = document.getElementById("stage");
        stageSelect.value = state.stage;

        stageSelect.addEventListener("change", (event) => {
          state.stage = event.target.value;
          renderSportPage(slug);
        });

        const ageInput = document.getElementById("age");
        ageInput.addEventListener("input", (event) => {
          const value = event.target.value;
          state.age = value;
          const numeric = Number(value);
          if (!Number.isNaN(numeric)) {
            state.stage = numeric < 18 ? "developing" : "performance";
          }
          renderSportPage(slug);
        });

        document.getElementById("change-sport").addEventListener("click", () => {
          window.location.hash = "";
        });

        attachPillarListeners(pillars);
        attachMovementListeners();
        attachSleepListeners();
        updateMovementBenchmark(norms);

        document.getElementById("results-btn").addEventListener("click", () => {
          state.lastResults = computeResults(sport);
          window.location.hash = `/results/${sport.slug}`;
        });
      };

      const renderPillarSection = (pillar) => {
        if (!pillar) return "";
        return `
          <div class="card" style="margin-bottom: 20px;">
            <h3>${pillar.title}</h3>
            <div class="grid two">
              ${pillar.subdomains
                .map(
                  (sub, subIndex) => `
                <div class="pillar-card">
                  <h4>${sub.title}</h4>
                  <div class="scale">
                    ${sub.questions
                      .map((question, questionIndex) => {
                        const id = buildQuestionId(pillar.key, subIndex, questionIndex);
                        return `
                          <div class="scale-item">
                            <p>${question}</p>
                            <div class="likert" data-question="${id}">
                              ${[1, 2, 3, 4, 5]
                                .map(
                                  (value) => `
                                <label>
                                  <input type="radio" name="${id}" value="${value}" ${
                                    state.responses[id] === value ? "checked" : ""
                                  } />
                                  <span>${value}</span>
                                </label>
                              `
                                )
                                .join("")}
                            </div>
                          </div>
                        `;
                      })
                      .join("")}
                  </div>
                </div>
              `
                )
                .join("")}
            </div>
          </div>
        `;
      };

      const renderMovementSection = () => `
        <div class="card" style="margin-bottom: 20px;">
          <h3>Functional Movement Style Screen</h3>
          <p>Score each movement task. Use 5 for competent, 3 for compensations, 1 for unable, 0 for pain present. Coach or athlete can score using the rubric.</p>
          <div class="movement-grid">
            ${state.movementScores
              .map(
                (task) => `
              <div class="movement-card">
                <h4>${task.task}</h4>
                <div class="grid two">
                  <div class="movement-placeholder">Ideal execution</div>
                  <div class="movement-placeholder">Common compensations</div>
                </div>
                <div class="likert" data-movement="${task.task}" style="margin-top: 10px;">
                  ${[5, 3, 1, 0]
                    .map(
                      (value) => `
                    <label>
                      <input type="radio" name="movement-${task.task}" value="${value}" ${
                        task.score === value ? "checked" : ""
                      } />
                      <span>${value}</span>
                    </label>
                  `
                    )
                    .join("")}
                </div>
              </div>
            `
              )
              .join("")}
          </div>
        </div>
      `;

      const renderSleepModule = (norms) => {
        const optimal = norms.sleepOptimal[state.stage];
        return `
          <div class="card" style="margin-bottom: 20px;">
            <h3>Sleep Module</h3>
            <p>How many hours do you typically sleep per night? The optimal target is <strong>${optimal}+ hours</strong> for ${state.stage} athletes.</p>
            <div class="controls">
              <input id="sleep-hours" type="number" min="0" max="12" step="0.5" value="${state.sleepHours}" />
            </div>
          </div>
        `;
      };

      const attachPillarListeners = (pillars) => {
        pillars.forEach((pillar) => {
          pillar.subdomains.forEach((sub, subIndex) => {
            sub.questions.forEach((_question, questionIndex) => {
              const id = buildQuestionId(pillar.key, subIndex, questionIndex);
              const radios = document.querySelectorAll(`input[name="${id}"]`);
              radios.forEach((radio) => {
                radio.addEventListener("change", (event) => {
                  state.responses[id] = Number(event.target.value);
                });
              });
            });
          });
        });
      };

      const attachMovementListeners = () => {
        state.movementScores.forEach((task) => {
          const radios = document.querySelectorAll(`input[name="movement-${task.task}"]`);
          radios.forEach((radio) => {
            radio.addEventListener("change", (event) => {
              const value = Number(event.target.value);
              task.score = value;
            });
          });
        });
      };

      const attachSleepListeners = () => {
        const input = document.getElementById("sleep-hours");
        if (input) {
          input.addEventListener("input", (event) => {
            state.sleepHours = Number(event.target.value);
          });
        }
      };

      const getPillarAverage = (pillarKey, pillars) => {
        const pillar = pillars.find((item) => item.key === pillarKey);
        if (!pillar) return 0;
        const values = [];
        pillar.subdomains.forEach((sub, subIndex) => {
          sub.questions.forEach((_question, questionIndex) => {
            const id = buildQuestionId(pillar.key, subIndex, questionIndex);
            const value = state.responses[id];
            if (value) values.push(value);
          });
        });
        if (!values.length) return 0;
        const avg = values.reduce((sum, value) => sum + value, 0) / values.length;
        return likertToPercent(avg);
      };

      const updateMovementBenchmark = (norms) => {
        const movementTotal = state.movementScores.reduce((sum, item) => sum + item.score, 0);
        const adjustedMean = norms.movement.mean + stageAdjustments[state.stage];
        const percentile = zToPercentile((movementTotal - adjustedMean) / norms.movement.sd);
        const band = bandFromPercentile(percentile);
        const node = document.getElementById("movement-benchmark");
        if (node) {
          node.textContent = `Movement screen percentile: ${Math.round(percentile)}th (${band}).`;
        }
      };

      const computeResults = (sport) => {
        const pillars = buildPillarsForSport(sport);
        const norms = normsBySport.get(sport.slug);
        const movementScores = state.movementScores.map((task) => task.score);
        const movementPercent = scoreMovement(movementScores);
        const optimalSleep = norms.sleepOptimal[state.stage];
        const sleepScore = Number.isNaN(state.sleepHours)
          ? 0
          : scoreSleep(state.sleepHours, optimalSleep);
        const movementTotal = movementScores.reduce((sum, value) => sum + value, 0);
        const movementPercentile = zToPercentile(
          (movementTotal - (norms.movement.mean + stageAdjustments[state.stage])) / norms.movement.sd
        );
        const movementBand = bandFromPercentile(movementPercentile);
        const sleepDelta = Number.isNaN(state.sleepHours) ? 0 : state.sleepHours - optimalSleep;
        const subdomainScores = getSubdomainScores(pillars);

        const pillarTotals = pillarKeys.reduce((acc, key) => {
          const base = getPillarAverage(key, pillars);
          if (key === "physical") {
            acc[key] = (base + movementPercent) / 2;
          } else if (key === "sleep") {
            acc[key] = base > 0 ? (base + sleepScore) / 2 : sleepScore;
          } else {
            acc[key] = base;
          }
          return acc;
        }, {});

        const pillarScores = pillarKeys.map((key) => {
          const mean = norms.pillars[key].mean + stageAdjustments[state.stage];
          const sd = norms.pillars[key].sd;
          const z = (pillarTotals[key] - mean) / sd;
          const percentile = zToPercentile(z);
          return {
            key,
            label: pillarTitles[key],
            score: pillarTotals[key],
            percentile,
            band: bandFromPercentile(percentile),
          };
        });

        const sorted = [...pillarScores].sort((a, b) => a.score - b.score);
        const constraints = sorted.slice(0, 2);
        const total = pillarScores.reduce((sum, item) => sum + item.score, 0) / pillarScores.length;
        const primaryConstraint = constraints[0] ? constraints[0].label : "a key pillar";
        const interpretation =
          total >= 75
            ? `Performance profile is strong, with ${primaryConstraint} as the main limiter.`
            : total >= 55
              ? `Profile is balanced but gains will come from lifting ${primaryConstraint}.`
              : `Profile shows foundational gaps; prioritize ${primaryConstraint} before adding volume.`;

        const recommendations = [
          `Prioritize ${primaryConstraint} work to match ${sport.name} demands.`,
          `Protect recovery windows during ${sport.competition} phases.`,
          `Use targeted monitoring around ${sport.riskProfile} signals.`,
        ];

        return {
          pillarScores,
          constraints,
          total,
          interpretation,
          recommendations,
          movementPercent,
          movementPercentile,
          movementBand,
          sleepScore,
          optimalSleep,
          sleepDelta,
          subdomainScores,
        };
      };

      const downloadResultsPng = () => {
        const node = document.getElementById("results-capture");
        if (!node) return;
        const rect = node.getBoundingClientRect();
        const width = Math.ceil(rect.width);
        const height = Math.ceil(node.scrollHeight);
        const styleTag = document.querySelector("style");
        const styles = styleTag ? styleTag.innerHTML : "";
        const serialized = `
          <svg xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}">
            <foreignObject width="100%" height="100%">
              <div xmlns="http://www.w3.org/1999/xhtml" style="width:${width}px;height:${height}px;background:#0a0b0c;">
                <style>${styles}</style>
                ${node.outerHTML}
              </div>
            </foreignObject>
          </svg>
        `;
        const blob = new Blob([serialized], { type: "image/svg+xml;charset=utf-8" });
        const url = URL.createObjectURL(blob);
        const img = new Image();
        const scale = window.devicePixelRatio || 1;

        img.onload = () => {
          const canvas = document.createElement("canvas");
          canvas.width = width * scale;
          canvas.height = height * scale;
          const ctx = canvas.getContext("2d");
          if (!ctx) return;
          ctx.scale(scale, scale);
          ctx.drawImage(img, 0, 0);
          URL.revokeObjectURL(url);
          const link = document.createElement("a");
          link.download = `results-${state.selectedSport || "sport"}.png`;
          link.href = canvas.toDataURL("image/png");
          link.click();
        };
        img.src = url;
      };

      const renderResultsPage = (slug) => {
        const sport = sportBySlug.get(slug);
        if (!sport) {
          renderLanding();
          return;
        }

        const results = computeResults(sport);
        state.lastResults = results;

        app.innerHTML = `
          <div id="results-capture">
            <section class="hero">
              <div class="card luxe">
                <span class="badge">Performance Output</span>
                <h1>${sport.name} Command Console</h1>
                <p>Elite summary of your eight-pillar profile, calibrated for ${sport.competition} intensity.</p>
                <div class="controls" style="margin-top: 16px;">
                  <button id="back-assessment" class="secondary" type="button">Back to Assessment</button>
                  <button id="change-sport" class="ghost" type="button">Change Sport</button>
                  <button id="download-results" type="button">Download Results PNG</button>
                </div>
              </div>
            </section>

            <section class="section">
              <div class="cockpit-grid">
                <div class="widget hero-widget">
                  <span class="chip">Total Performance Index</span>
                  <div class="big-number">${results.total.toFixed(1)}</div>
                  <p>${results.interpretation}</p>
                </div>
                <div class="widget">
                  <span class="chip">Primary Constraint</span>
                  <div class="big-label">${results.constraints[0] ? results.constraints[0].label : "None detected"}</div>
                  <div class="flag ${results.constraints[0] ? results.constraints[0].band === "Low" ? "low" : results.constraints[0].band === "Average" ? "avg" : "high" : "avg"}">
                    ${results.constraints[0] ? results.constraints[0].band : "Average"}
                  </div>
                </div>
                <div class="widget">
                  <span class="chip">Sleep Readiness</span>
                  <div class="dial" style="--value:${Math.round(results.sleepScore)};">
                    <span>${Math.round(results.sleepScore)}</span>
                    <em>Sleep</em>
                  </div>
                </div>
                <div class="widget">
                  <span class="chip">Movement Screen</span>
                  <div class="dial" style="--value:${Math.round(results.movementPercent)};">
                    <span>${Math.round(results.movementPercent)}</span>
                    <em>Movement</em>
                  </div>
                  <p>${Math.round(results.movementPercentile)}th percentile (${results.movementBand}).</p>
                </div>
              </div>
            </section>

            <section class="section">
              <h2>Eight-Pillar Cockpit Dials</h2>
              <div class="dial-grid">
                ${results.pillarScores
                  .map(
                    (score) => `
                  <div class="widget dial-widget">
                    <span class="chip">${score.label}</span>
                    <div class="dial" style="--value:${Math.round(score.score)};">
                      <span>${Math.round(score.score)}</span>
                      <em>${score.band}</em>
                    </div>
                    <div class="pill">${Math.round(score.percentile)}th percentile</div>
                  </div>
                `
                  )
                  .join("")}
              </div>
            </section>

            <section class="section">
              <h2>Performance Infographic</h2>
              <div class="infographic">
                ${results.subdomainScores
                  .map(
                    (score) => `
                  <div class="bar-row ${score.pillarKey}">
                    <span>${score.pillarTitle} - ${score.subdomainTitle}</span>
                    <div class="bar">
                      <div class="bar-fill" style="width:${Math.round(score.score)}%"></div>
                    </div>
                    <strong>${Math.round(score.score)}</strong>
                  </div>
                `
                  )
                  .join("")}
              </div>
            </section>

            <section class="section">
              <div class="grid two" style="align-items: center;">
                <div class="widget">
                  <span class="chip">Sleep & Recovery Lollipop</span>
                  <p>Optimal target: ${results.optimalSleep}+ hours</p>
                  <div class="lollipop">
                    <div class="lollipop-track">
                      <span class="lollipop-center"></span>
                      <span
                        class="lollipop-dot ${results.sleepDelta < 0 ? "low" : results.sleepDelta > 0 ? "high" : "avg"}"
                        style="left:${Math.min(100, Math.max(0, 50 + results.sleepDelta * 10))}%"
                      ></span>
                    </div>
                    <div class="lollipop-labels">
                      <span>Below optimal</span>
                      <span>Optimal</span>
                      <span>Above optimal</span>
                    </div>
                  </div>
                  <p>${state.sleepHours}h actual vs ${results.optimalSleep}h target</p>
                </div>
                <div class="widget">
                  <span class="chip">Sport-Specific Recommendations</span>
                  <ul>
                    ${results.recommendations.map((rec) => `<li>${rec}</li>`).join("")}
                  </ul>
                </div>
              </div>
            </section>
          </div>
        `;

        document.getElementById("back-assessment").addEventListener("click", () => {
          window.location.hash = `/sport/${sport.slug}`;
        });

        document.getElementById("change-sport").addEventListener("click", () => {
          window.location.hash = "";
        });

        document.getElementById("download-results").addEventListener("click", () => {
          downloadResultsPng();
        });

      };

      window.addEventListener("hashchange", route);
      route();
    </script>
  </body>
</html>
